<UserControl x:Class="DoAnWPF.Views.pos"
             x:Name="Root"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:DoAnWPF.views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d">
    <UserControl.Resources>
        <local:ImagePathConverter x:Key="ImagePathConverter"/>
    </UserControl.Resources>
    <Grid Background="White">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="auto"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT: Categories + Products -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- categories -->
                <RowDefinition Height="*"/>
                <!-- products -->
            </Grid.RowDefinitions>

            <!-- Categories -->
            <ScrollViewer Grid.Row="0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled" Margin="8">
                <StackPanel Orientation="Horizontal">
                    <!-- Nút Tất cả -->
                    <Button Content="Tất cả" Margin="4" Padding="8,4" Click="AllCategory_Click"/>

                    <!-- Các category động -->
                    <ItemsControl x:Name="CategoryList">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Content="{Binding TenLoai}" 
                            Margin="4" Padding="8,4" 
                            Click="Category_Click"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>


            <!-- Products -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="8">
                <ItemsControl x:Name="ProductsControl">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" ItemWidth="160"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Click="Product_Click" 
                                    Background="Transparent" BorderThickness="0" Padding="0" Margin="6">
                                <Border Background="White" CornerRadius="8" BorderBrush="#DDD" BorderThickness="1" Width="150" Padding="8">
                                    <StackPanel>
                                        <Image Source="{Binding HinhAnh, Converter={StaticResource ImagePathConverter}}" Height="80" Stretch="Uniform"/>
                                        <TextBlock Text="{Binding TenSanPham}" FontWeight="Bold" TextWrapping="Wrap" Margin="0,6,0,0"/>
                                        <TextBlock Text="{Binding GiaBan, StringFormat={}{0:N0}}" Foreground="Green" FontWeight="Bold" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Grid>

        <!-- RIGHT: Cart + Customer + Payment -->
        <Grid Grid.Column="1" Background="#F9F9F9" Margin="10" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- customer -->
                <RowDefinition Height="*"/>
                <!-- cart -->
                <RowDefinition Height="Auto"/>
                <!-- payment -->
            </Grid.RowDefinitions>

            <!-- Customer -->
            <StackPanel Grid.Row="0" Margin="0,0,0,10">
                <TextBlock Text="Khách hàng" FontWeight="Bold" FontSize="16"/>

                <!-- Nhập tên khách hàng -->
                <StackPanel Orientation="Vertical" Margin="0,6,0,0">
                    <Label Content="Tên khách hàng"/>
                    <TextBox x:Name="CustomerName" Height="28"/>
                </StackPanel>

                <!-- Nhập số điện thoại + nút tìm + submit -->
                <Grid Margin="0,6,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Vertical">
                        <Label Content="Số Điện thoại"/>
                        <TextBox x:Name="CustomerPhone" Height="28"/>
                    </StackPanel>

                    <Button Grid.Column="1" Content="Tìm" Width="60" Margin="6,22,0,0"
                Click="FindCustomer_Click"/>
                
                </Grid>
            </StackPanel>



            <StackPanel Grid.Row="1">
                <TextBlock Text="Sản phẩm" FontWeight="Bold" FontSize="16" Margin="0,0,0,6"/>
                <ListView x:Name="CartList" Height="320" Width="380">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Tên" Width="100" DisplayMemberBinding="{Binding Name}"/>
                            <GridViewColumn Header="Giá" Width="80" DisplayMemberBinding="{Binding Price}"/>
                            <GridViewColumn Header="SL" Width="100">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="-" Width="28" Height="24" Click="Decrease_Click"/>
                                            <TextBlock Text="{Binding Quantity}" Width="34" TextAlignment="Center" VerticalAlignment="Center" Margin="6,0"/>
                                            <Button Content="+" Width="28" Height="24" Click="Increase_Click"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Tổng" Width="100" DisplayMemberBinding="{Binding Total}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </StackPanel>

            <!-- Payment -->
            <StackPanel Grid.Row="2" Margin="0,10,0,0">
                <TextBlock x:Name="TotalTextBlock" Text="Thành tiền: 0đ" 
                           FontWeight="Bold" FontSize="16" Foreground="Green" Margin="0,0,0,6"/>
                <Button Content="THANH TOÁN" Height="40" Background="Blue" Foreground="White" Click="Button_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
